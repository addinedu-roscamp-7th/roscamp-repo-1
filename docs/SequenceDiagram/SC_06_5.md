@startuml SC_06_5_Pickee_적재완료및이동
!theme plain

actor 사용자
participant "LLM Service" as llm
participant "Pickee\nMain Controller" as pickee_main
participant "Pickee\nMobile Controller" as pickee_mobile

== 상품 적재 완료 ==

사용자 -> pickee_main: 음성 "적재 완료"
activate pickee_main
pickee_main -> pickee_main: STT (음성 → 텍스트)
pickee_main -> llm: [HTTP] 텍스트 전달\n(IF_HTTP_02: intent_detection)
activate llm
llm -> llm: 텍스트 분석
llm --> pickee_main: [HTTP] 텍스트 분석 결과\n(intent_detection_result)
deactivate llm

pickee_main -> pickee_main: 음성 송출 ("적재 완료 확인")

pickee_main -> pickee_main: Pickee 상태 변경\n(WAITING_LOADING->MOVING_TO_STAFF)

pickee_main -> pickee_main: 저장된 직원 위치로\nGlobal Path 계획

== 목적지 이동 ==

pickee_main -> pickee_mobile: [Service] 목적지 이동 명령\n(/pickee/mobile/move_to_location)
activate pickee_mobile
pickee_mobile --> pickee_main: [Service Resp] 목적지 이동 명령 응답

pickee_mobile -> pickee_mobile: Local Path Planning
pickee_mobile -> pickee_mobile: 경로 추종
pickee_mobile -> pickee_mobile: 목적지 이동 확인
pickee_mobile --> pickee_main: [Topic] 도착 알림\n(/pickee/mobile/arrival)
deactivate pickee_mobile

== 도착 안내 ==

pickee_main -> pickee_main: 음성 송출 ("요청하신 상품이 도착했습니다.")

pickee_main -> pickee_main: Pickee 상태 변경\n(MOVING_TO_STAFF->WAITING_UNLOADING)

deactivate pickee_main

@enduml
