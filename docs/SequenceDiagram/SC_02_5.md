@startuml SC_02_5
!theme plain
skinparam backgroundColor #FFFFFF
skinparam sequenceMessageAlign center

actor User as user
participant "Shopee App" as app
participant "Shopee\nMain Service" as main
participant "DB Manager" as db
participant "Pickee\nMain Controller" as pickee

user -> app: 쇼핑 종료
activate app

app -> main: [TCP] 쇼핑 종료\n(shopping_end)
activate main

main -> db: 담은 상품 업데이트
activate db

db -> db: DB 업데이트
activate db #DarkSalmon
deactivate db

db --> main: 담은 상품 업데이트 완료
deactivate db

main -> pickee: [ROS2 Service] 쇼핑 종료 명령
(/pickee/workflow/end_shopping)
activate pickee

pickee -> pickee: 로봇 상태 전환\n(오토픽업 -> 포장대이동)
activate pickee #DarkSalmon
deactivate pickee

pickee --> main: [ROS2 Service] 쇼핑 종료 명령 응답\n(/pickee/workflow/end_shopping)
deactivate pickee

main --> app: [TCP] 쇼핑 종료됨\n(shopping_end_response)
deactivate main

app -> app: 쇼핑 종료 알림
activate app #DarkSalmon
deactivate app

deactivate app

@enduml