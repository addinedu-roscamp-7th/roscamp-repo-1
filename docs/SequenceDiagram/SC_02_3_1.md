@startuml SC_02_3_1_자동선택
!theme plain
skinparam backgroundColor #FFFFFF
skinparam sequenceMessageAlign center

participant "Shopee\nMain Service" as main
participant "Pickee\nMain Controller" as pickee_main
participant "Pickee\nVision AI Service" as vision
participant "Pickee\nArm Controller" as pickee_arm

pickee_main -> main: [ROS2 Topic] 도착 보고\n(/pickee/arrival_notice)

main -> pickee_main: [ROS2 Service] 상품 인식 명령\n(/pickee/detect_products)
activate pickee_main

pickee_main --> main: [ROS2 Service] 상품 인식 명령 응답\n(/pickee/detect_products)

pickee_main -> pickee_arm: [ROS2 Service] 자세 변경 요청\n(/pickee/arm/move_to_pose, pose_type=shelf_view)
activate pickee_arm

pickee_arm -> pickee_arm: 매대 확인 자세\n실행
activate pickee_arm #DarkSalmon
deactivate pickee_arm

pickee_arm --> pickee_main: [ROS2 Service] 자세 변경 응답\n(/pickee/arm/move_to_pose)

pickee_arm -> pickee_main: [ROS2 Topic] 자세 변경 상태\n(/pickee/arm/pose_status)
deactivate pickee_arm

pickee_main -> vision: [ROS2 Service] 매대 상품 인식 요청\n(/pickee/vision/detect_products)
activate vision

vision -> vision: 상품 인식
activate vision #DarkSalmon
deactivate vision

vision --> pickee_main: [ROS2 Service] 매대 상품 인식 응답\n(/pickee/vision/detect_products)

vision -> pickee_main: [ROS2 Topic] 매대 상품 인식 완료\n(/pickee/vision/detection_result)
deactivate vision

deactivate pickee_main

@enduml