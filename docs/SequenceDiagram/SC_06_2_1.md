@startuml SC_06_2_1_Pickee_직원등록
!theme plain

participant "Pickee\nMain Controller" as pickee_main
participant "Pickee\nVision AI Service" as pickee_vision

== 재고 보충 모드 시작 ==

activate pickee_main
pickee_main -> pickee_main: 음성 송출 ("재고 보충 모드를 시작합니다")
pickee_main -> pickee_main: 음성 송출 ("등록을 시작합니다.")

== Vision 등록 모드 전환 ==

pickee_main -> pickee_vision: [Service] 인식 모드 전환 요청\n(/pickee/vision/set_mode)
activate pickee_vision
pickee_vision -> pickee_vision: 인식 모드 전환 (주행모드 → 등록모드)
pickee_vision --> pickee_main: [Service Resp] 인식 모드 전환 성공
deactivate pickee_vision

== 직원 외형 등록 ==

pickee_main -> pickee_vision: [Service] 직원 등록 요청\n(/pickee/vision/register_staff)
activate pickee_vision
pickee_vision --> pickee_main: [Service Resp] 등록 절차 시작
deactivate pickee_vision

group 비동기 작업 (Async Task)
    pickee_vision -> pickee_main: [Service] 음성 송출 요청\n(/pickee/tts_request)
    activate pickee_main
    pickee_main -> pickee_main: 음성 송출 ("카메라 정면을 봐주세요.")
    pickee_main --> pickee_vision: [Service Resp] 음성 송출 완료
    deactivate pickee_main
    pickee_vision -> pickee_vision: 정면 특징 추출

    pickee_vision -> pickee_main: [Service] 음성 송출 요청\n(/pickee/tts_request)
    activate pickee_main
    pickee_main -> pickee_main: 음성 송출 ("뒤로 돌아주세요.")
    pickee_main --> pickee_vision: [Service Resp] 음성 송출 완료
    deactivate pickee_main
    pickee_vision -> pickee_vision: 후면 특징 추출 및 최종 저장

    pickee_vision -> pickee_main: [Topic] 등록 결과 전송\n(/pickee/vision/register_staff_result)
end

pickee_main -> pickee_main: 음성 송출 ("등록이 완료되었습니다.")

pickee_main -> pickee_main: Pickee 상태 변경\n(REGISTERING_STAFF->FOLLOWING_STAFF)

deactivate pickee_main

@enduml
