@startuml SC_06_2_1_Pickee_직원등록
!theme plain
skinparam backgroundColor #FFFFFF
skinparam sequenceMessageAlign center

participant "Pickee\nMain Controller" as pickee_main
participant "Pickee\nVision AI Service" as pickee_vision

== 직원 보조 모드 시작 ==

activate pickee_main
pickee_main -> pickee_main: 음성 송출 ("직원 보조 모드를 시작합니다")
activate pickee_main #DarkSalmon
deactivate pickee_main

pickee_main -> pickee_main: 음성 송출 ("등록을 시작합니다.")
activate pickee_main #DarkSalmon
deactivate pickee_main

== Vision 등록 모드 전환 ==

pickee_main -> pickee_vision: [ROS2 Service] 인식 모드 전환 요청\n(/pickee/vision/set_mode)
activate pickee_vision
pickee_vision -> pickee_vision: 인식 모드 전환 (주행모드 -> 등록모드)
activate pickee_vision #DarkSalmon
deactivate pickee_vision
pickee_vision --> pickee_main: [ROS2 Service] 인식 모드 전환 성공\n(/pickee/vision/set_mode)

== 직원 외형 등록 ==

pickee_main -> pickee_vision: [ROS2 Service] 직원 등록 요청\n(/pickee/vision/register_staff)
pickee_vision --> pickee_main: [ROS2 Service] 직원 등록 절차 시작\n(/pickee/vision/register_staff)

'-- 정면 등록 --'
pickee_vision -> pickee_main: [ROS2 Service] 음성 송출 요청\n(/pickee/tts_request, text="카메라 정면을 봐주세요")
activate pickee_main
pickee_main -> pickee_main: 음성 송출 ("카메라 정면을 봐주세요.")
activate pickee_main #DarkSalmon
deactivate pickee_main
pickee_main --> pickee_vision: [ROS2 Service] 음성 송출 성공\n(/pickee/tts_request)
deactivate pickee_main

pickee_vision -> pickee_vision: 정면 특징 추출
activate pickee_vision #DarkSalmon
deactivate pickee_vision

'-- 후면 등록 --'
pickee_vision -> pickee_main: [ROS2 Service] 음성 송출 요청\n(/pickee/tts_request, text="뒤로 돌아주세요")
activate pickee_main
pickee_main -> pickee_main: 음성 송출 ("뒤로 돌아주세요.")
activate pickee_main #DarkSalmon
deactivate pickee_main
pickee_main --> pickee_vision: [ROS2 Service] 음성 송출 성공\n(/pickee/tts_request)
deactivate pickee_main

pickee_vision -> pickee_vision: 후면 특징 추출
activate pickee_vision #DarkSalmon
deactivate pickee_vision

'-- 등록 완료 --'
pickee_vision -> pickee_main: [ROS2 Topic] 등록 결과 전송\n(/pickee/vision/register_staff_result)
deactivate pickee_vision

pickee_main -> pickee_main: 음성 송출 ("등록이 완료되었습니다.")
activate pickee_main #DarkSalmon
deactivate pickee_main

pickee_main -> pickee_main: Pickee 상태 전환\n(REGISTERING_STAFF->FOLLOWING_STAFF)
activate pickee_main #DarkSalmon
deactivate pickee_main

deactivate pickee_main
@enduml
