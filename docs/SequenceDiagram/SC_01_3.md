@startuml SC_01_3
!theme plain
skinparam backgroundColor #FFFFFF
skinparam sequenceMessageAlign center

actor User as user
participant "Shopee App" as app
participant "Shopee\nMain Service" as main
participant "DB Manager" as db
participant "Pickee\nMain Controller" as pickee

user -> app: 결제 클릭
activate app

app -> app: 배정 중\n화면 전환
activate app #DarkSalmon
deactivate app

app -> main: [TCP] 주문 생성\n(order_create)\n(customer_id, 상품 리스트)
activate main

main -> main: 가용 Pickee 선택
activate main #DarkSalmon
deactivate main

main -> db: 주문 정보 생성 요청
activate db

db -> db: order_info 생성
activate db #DarkSalmon
deactivate db

db -> db: order_item_info 생성
activate db #DarkSalmon
deactivate db

db --> main: 저장완료\n(order_id)
deactivate db

main -> pickee: [ROS2 Service] 작업 시작 명령\n(/pickee/workflow/start_task)
activate pickee

pickee -> pickee: 작업 가능 여부\n확인
activate pickee #DarkSalmon
deactivate pickee

pickee --> main: [ROS2 Service] 작업 시작 응답\n(/pickee/workflow/start_task)
deactivate pickee

main --> app: [TCP] 주문 생성 응답\n(order_create_response)\n(세션 ID, order_id)
deactivate main

app -> app: 결제 완료\n화면 전환
activate app #DarkSalmon
deactivate app

app -> app: 쇼핑중\n화면 전환
activate app #DarkSalmon
deactivate app

deactivate app

@enduml