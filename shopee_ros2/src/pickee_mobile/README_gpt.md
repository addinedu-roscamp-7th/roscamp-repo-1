# 🦾 Pickee Mobile ROS2 Package

`pickee_mobile` 패키지는 **Shopee 로봇 쇼핑 시스템**의 **Pickee Mobile
로봇**을 위한 ROS2 기반 제어 시스템입니다.\
이 패키지는 **Pickee Main Controller**의 지시에 따라 로봇의 자율 이동,
위치 추정, 경로 계획, 모션 및 속도 제어를 수행하며 로봇의 상태를
보고합니다.

------------------------------------------------------------------------

## 📦 1. 패키지 개요

`pickee_mobile` 패키지는 Pickee Mobile 로봇의 **핵심 제어 로직**과
**테스트용 구성요소**로 구성되어 있습니다.

    pickee_mobile/
    ├── main/     # 핵심 기능 구현 (완성된 코드)
    └── test/     # 테스트용 코드 모음
        ├── mock_test/   # 통신 테스트 코드
        ├── goal_test/   # 목적지 지정 및 위치 토픽 구독 테스트
        └── topic_test/  # 속도 제어 및 토픽 발행 테스트

### 🔹 특이사항

-   PickeeMobile이 **속도 명령을 수신하는 토픽 이름은
    `/cmd_vel_modified`** 입니다.\
    (기존 `/cmd_vel` 대신 사용)
-   이는 **속도 제어 및 수정 노드(`mobile_vel_modifier`)** 와의 연동을
    위해 변경되었습니다.\
    속도 관련 오류 발생 시, 이 토픽 이름이 올바르게 설정되어 있는지
    반드시 확인하세요.

------------------------------------------------------------------------

## ⚙️ 2. 실행 방법

### 🚀 2.1 시뮬레이션 실행

> 아직 실제 시뮬레이션 테스트는 진행되지 않았으나, 일반적인 실행 순서는
> 다음과 같습니다.

``` bash
# 1. Gazebo 시뮬레이터 실행
ros2 launch pickee_mobile gazebo_bringup.launch.xml

# 2. Nav2 실행 (지도 지정), 1번 실행 완료 이후에 실행하는걸 권장
ros2 launch pickee_mobile nav2_bringup_launch.xml map:=map1021_modify.yaml

# 3. RViz 실행
ros2 launch pickee_mobile nav2_view.launch.xml

# 4. 속도 제어 노드 실행
ros2 launch pickee_mobile mobile_controller.launch.xml
```

------------------------------------------------------------------------

### 🤖 2.2 실제 로봇 주행

``` bash
# 1. 로봇 Bringup (실제 하드웨어)
ros2 launch pickee_mobile mobile_bringup.launch.xml

# 2. Nav2 실행 (지도 지정), 1번 실행 완료 이후에 실행하는걸 권장
ros2 launch pickee_mobile nav2_bringup_launch.xml map:=map1021_modify.yaml

# 3. RViz 실행 (PC 측)
ros2 launch pickee_mobile nav2_view.launch.xml

# 4. 제어 노드 실행 (PC 측)
ros2 launch pickee_mobile mobile_controller.launch.xml
```

------------------------------------------------------------------------

## 🔧 3. 구성 파일 설명

  ---------------------------------------------------------------------------------------
  파일명                             역할                           비고
  ---------------------------------- ------------------------------ ---------------------
  **mobile_bringup.launch.xml**      PickeeMobile 로봇 초기화 (수업 실제 하드웨어 bringup
                                     자료 기반)                     

  **nav2_bringup_launch.xml**        Nav2 실행 및 지도 불러오기     map 인자 설정
                                     (`map:=map1021_modify.yaml`)   가능

  **nav2_view.launch.xml**           RViz 실행 (시각화용)

  **mobile_controller.launch.xml**   `mobile_controller`,           속도 및 경로 제어
  
  `mobile_vel_modifier` 노드     핵심
  실행
                             
  

------------------------------------------------------------------------

## 🧠 4. 주요 노드 기능 요약

### 🟢 `mobile_controller` 노드

  -----------------------------------------------------------------------
  기능                                설명
  ----------------------------------- -----------------------------------
  **목적지 지정 서비스 서버**         외부 요청으로 목표 위치 설정

  **주행 명령 액션 클라이언트**       Nav2 `NavigateToPose` 액션 호출

  **PickeeMobile 상태 발행**          위치, 속도, 배터리 등 상태 주기적
                                      publish

  **도착 정보 발행**                  목표 지점 도달 여부 publish
  -----------------------------------------------------------------------

------------------------------------------------------------------------

### 🟣 `mobile_vel_modifier` 노드

  기능                         설명
  ---------------------------- --------------------------------------------
  **/cmd_vel 구독**            Nav2 또는 teleop에서 발행된 속도 명령 수신
  **속도 조정 로직**           환경 설정에 따라 속도 스케일 변경
  **/cmd_vel_modified 발행**   수정된 속도 명령을 PickeeMobile에 전달

------------------------------------------------------------------------

## 🧩 5. 참고사항

-   속도 관련 통신이 올바르지 않다면 `/cmd_vel_modified` 구독/발행
    관계를 우선 확인하세요.
-   실제 로봇 환경에서는 **`mobile_bringup` → `nav2_bringup` →
    `nav2_view` → `mobile_controller`** 순서로 실행하는 것이
    안정적입니다.

------------------------------------------------------------------------

## 📚 6. 향후 계획 (선택 사항)

-   [ ] 시뮬레이션 환경 테스트 (Gazebo + Nav2 통합)
-   [ ] 속도제어 튜닝 및 장애물 회피 실험
-   [ ] DB 연동 및 로봇 상태 로깅 기능 추가

------------------------------------------------------------------------

✨ **Pickee Mobile** --- *자율 쇼핑 로봇의 핵심 동력* ✨\
\> "한 번의 명령으로, 매끄러운 주행과 완벽한 도착을."
